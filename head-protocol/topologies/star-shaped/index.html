<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/head-protocol/adr/rss.xml" title="Hydra: Head Protocol RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/head-protocol/adr/atom.xml" title="Hydra: Head Protocol Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hydra: Head Protocol" href="/head-protocol/opensearch.xml">
<script src="https://plausible.io/js/script.js" defer="defer" data-domain="hydra.family"></script><title data-rh="true">Star-Shaped Head Network | Hydra: Head Protocol</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://input-output-hk.github.io/head-protocol/topologies/star-shaped/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-topologies-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-topologies-current"><meta data-rh="true" property="og:title" content="Star-Shaped Head Network | Hydra: Head Protocol"><meta data-rh="true" name="description" content="This document is a work in progress"><meta data-rh="true" property="og:description" content="This document is a work in progress"><link data-rh="true" rel="icon" href="/head-protocol/img/hydra.png"><link data-rh="true" rel="canonical" href="https://input-output-hk.github.io/head-protocol/topologies/star-shaped/"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/topologies/star-shaped/" hreflang="en"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/fr/topologies/star-shaped/" hreflang="fr"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/ja/topologies/star-shaped/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/topologies/star-shaped/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YZTAF8IOVB-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/head-protocol/assets/css/styles.e706d711.css">
<link rel="preload" href="/head-protocol/assets/js/runtime~main.372fac57.js" as="script">
<link rel="preload" href="/head-protocol/assets/js/main.53825789.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/head-protocol/"><div class="navbar__logo"><img src="/head-protocol/img/hydra.png" alt="Hydra: Head Protocol" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/head-protocol/img/hydra-white.png" alt="Hydra: Head Protocol" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Hydra: Head Protocol</b></a><a class="navbar__item navbar__link" href="/head-protocol/docs/getting-started">User Manual</a><a class="navbar__item navbar__link" href="/head-protocol/use-cases">Use Cases</a><a class="navbar__item navbar__link" href="/head-protocol/core-concepts">Core Concepts</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/head-protocol/topologies">Topologies</a><a class="navbar__item navbar__link" href="/head-protocol/benchmarks">Benchmarks</a><a class="navbar__item navbar__link" href="/head-protocol/api-reference">API Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/input-output-hk/hydra-poc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/head-protocol/topologies/star-shaped/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/head-protocol/fr/topologies/star-shaped/" target="_self" rel="noopener noreferrer" class="dropdown__link">Fran√ßais</a></li><li><a href="/head-protocol/ja/topologies/star-shaped/" target="_self" rel="noopener noreferrer" class="dropdown__link">Êó•Êú¨Ë™û</a></li></ul></div><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/topologies/">Topologies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/topologies/basic/">Basic Hydra Head</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/head-protocol/topologies/star-shaped/">Star-shaped Network</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/head-protocol/">üè†</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/head-protocol/topologies/star-shaped/">Star-shaped Network</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Star-Shaped Head Network</h1><p>üõ†Ô∏è This document is a work in progress</p><p>This document details the behaviour of so-called <em>Star-shaped Hydra Network</em>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>A <em>Star-shaped Hydra Network</em> or more precisely a Star-shaped Heads Network is comprised of:</p><ul><li>A central <em>Server</em> node providing &quot;Head-as-a-service&quot;, with low expected downtime, probably operated by some company or organisation with enough resources to host this service,</li><li><em>Client</em> nodes, either DApp instances, or mobile/personal wallets, which might not be always online and possibly can come and go.</li></ul><p><img loading="lazy" alt="Star-shaped Heads Network" src="/head-protocol/assets/images/star-shaped-general-532cfafec07585ab262bbbee9acee8eb.jpg" width="4862" height="3290"></p><p>Client nodes want to be able to interact with each other efficiently, at a low cost, using L2 solution, with all the Hydra safety guarantees, but without bearing the operational burden of operating an always online &quot;full&quot; Hydra node (eg. using an embedded version of the node, or a lightweight version). There might be a lot of them, say in the 100s or even 1000s but they are not always all live and up at the same time.</p><p>Client nodes establish pairwise Heads (eg. <em>channels</em>) with the server: This setup is simpler than with a normal multiparty head because the server has as a well-known identity and the client can always provide the needed parameters (keys, IP) to the server when setting up the Head using some specific service whose definition is outside of the scope of this document.</p><p>Transactions a client node posts in &quot;its&quot; Head should be <em>reflected</em> by the server into the other Heads it maintain.</p><p><em>Questions</em>:</p><ul><li>Is it expected the pairwise Heads to have varying &quot;durations&quot;, eg. a client comes, opens a Head, does some stuff, and closes it but the other Heads maintained by the same server stay <em>Open</em>?</li><li>How does the server provided guarantees preserving the basic <em>Safety property</em> of Hydra Heads for each of the pairwise heads?<ul><li>What the diagram suggest is to use <em>Hash Time-Lock Contracts</em> (<a href="https://docs.lightning.engineering/the-lightning-network/multihop-payments/hash-time-lock-contract-htlc" target="_blank" rel="noopener noreferrer">HTLC</a>) which ensures the Client can always get its UTxO back if the server does not properly route the transaction to its destination</li></ul></li><li>What kind of transaction should be supported? HTLC are good for payments-style transactions but not for DApps for example, or they would need to be adapted<ul><li>There seems to be an implicit assumption that the server can &quot;route&quot; a transaction in one Head to the proper Head which implies it &quot;understands&quot; the addresses of UTxO posted in Heads</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="on-chain-transactions">On-Chain Transactions<a class="hash-link" href="#on-chain-transactions" title="Direct link to heading">‚Äã</a></h2><p>The following transaction diagram represents the lifecycle of 2 pairwise Heads between <strong>A</strong>lice, <strong>B</strong>ob and <strong>S</strong>erver.</p><p><img loading="lazy" alt="Star-shaped Network On-Chain" src="/head-protocol/assets/images/star-shaped-txs-bef2a52039a88dc3cbd49358322377bd.png" width="1897" height="413"></p><p><em>Remarks</em>:</p><ul><li>This assumes the transactions happening in one head are reflected in the other head, thus resulting in a (strongly) consistent final UTxO <code>c</code><ul><li>This means both heads must start with the <em>same</em> $U_0$ set which I don&#x27;t know how can be done (highlighted in red in the diagram)</li><li>If the final UTxO set is consistent, then it can be fanned-out by any party, which means one <code>ŒΩ_head</code> can stay dangling and become unspendable as it would recreating an already existing UTxO (grayed out transaction in the diagram)</li></ul></li><li>The lifecycle of the heads are tied: When one is closed, the other is closed. The server will ensure that it is the case.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="off-chain-transactions">Off-Chain Transactions<a class="hash-link" href="#off-chain-transactions" title="Direct link to heading">‚Äã</a></h2><p>The following picture represents the sequence of messages exchanged between the various <code>Node</code>s in order to ensure propagation of transactions.</p><p><img loading="lazy" alt="Star-shaped Network Off-Chain Protocol" src="/head-protocol/assets/images/off-chain-protocol-e3962146cdd4905688da7c366154f834.png" width="520" height="757"></p><p><em>Remarks</em>:</p><ul><li>The Server is represented by 2 nodes, <code>M(A)</code> and <code>M(B)</code>,</li><li>The <code>newTx</code> issued by <code>Alice</code> through her node will be propagated by Server to <code>Bob</code>&#x27;s node as <code>newTx</code> too</li><li>This diagram does not represent any possible additional transactions the Server would need to post in order to provide guarantees to either or both <code>Alice</code> and <code>Bob</code> (e.g an in-head HTLC transaction)</li><li>In order to ensure consistency of snapshots, the Server is assumed to always be the leader, ie. the one triggering the emission of a snapshot.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/input-output-hk/hydra-poc/tree/master/docs/topologies/star-shaped/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/head-protocol/topologies/basic/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Basic Hydra Head</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#on-chain-transactions" class="table-of-contents__link toc-highlight">On-Chain Transactions</a></li><li><a href="#off-chain-transactions" class="table-of-contents__link toc-highlight">Off-Chain Transactions</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/input-output-hk/hydra-poc/wiki/Coding-Standards" target="_blank" rel="noopener noreferrer" class="footer__link-item">Coding Standards</a></li><li class="footer__item"><a class="footer__link-item" href="/head-protocol/adr">Architectural Decision Records</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra-poc/wiki/Testing-Strategy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testing Strategy</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/Qq5vNTg9PT" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord (#ask-hydra)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra-poc/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://cardano.stackexchange.com/questions/tagged/hydra" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Exchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/head-protocol/docs/haskell_packages">Haskell Packages</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra-poc/wiki/Logbook" target="_blank" rel="noopener noreferrer" class="footer__link-item">Logbook</a></li><li class="footer__item"><a href="https://iohk.io/en/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Input Output (Blog)</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 <strong>Input Output</strong> <br> <small>Built with Docusaurus</small></div></div></div></footer></div>
<script src="/head-protocol/assets/js/runtime~main.372fac57.js"></script>
<script src="/head-protocol/assets/js/main.53825789.js"></script>
</body>
</html>